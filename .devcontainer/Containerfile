FROM docker.io/fedora:latest

RUN \
  dnf update -y \
  && dnf install -y \
    @development-tools \
    btop \
    cmake \
    clang \
    clang-tools-extra-devel \
    compiler-rt \
    doxygen \
    fish \
    gawk \
    helix \
    just \
    libcxx-devel \
    lldb \
    llvm \
    mold \
    ninja \
    uv \
    wget \
  && dnf clean all && rm -rf /var/cache/dnf

SHELL ["/bin/fish", "-c"]

RUN useradd -ms /bin/fish dev
USER dev

# Fish completions

# just: https://just.systems/man/en/shell-completion-scripts.html
RUN just --completions fish > ~/.config/fish/completions/just.fish

# uv: https://docs.astral.sh/uv/getting-started/installation/#shell-autocompletion
RUN echo 'uv generate-shell-completion fish | source' > ~/.config/fish/completions/uv.fish
RUN echo 'uvx --generate-shell-completion fish | source' > ~/.config/fish/completions/uvx.fish
