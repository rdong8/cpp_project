// clang-format off
// clang-format doesn't support JSON with comments
// Podman notes:
// - https://code.visualstudio.com/remote/advancedcontainers/docker-options#_podman
// - https://universal-blue.discourse.group/t/should-we-really-recommend-vscode-podman-as-supported/220/3
{
  "name": "Dev Container",
  "containerEnv": {
    // For Podman
    "HOME": "/home/dev"
  },
  // For Podman
  "remoteUser": "dev",
  "capAdd": [
    // For C++
    "SYS_PTRACE"
  ],
  "securityOpt": [
    // For C++
    "seccomp=unconfined",
    // For Podman
    "label=disable"
  ],
  "mounts": [
    {
      "source": "conan",
      "target": "/home/dev/.conan2",
      "type": "volume"
    }
  ],
  "customizations": {
    "vscode": {
      "extensions": [
        // Base extensions
        "DavidAnson.vscode-markdownlint",
        "charliermarsh.ruff",
        "cheshirekow.cmake-format",
        "cschlosser.doxdocgen",
        "denoland.vscode-deno",
        // Formatting for JSON, etc.
        "docker.docker",
        "eamodio.gitlens",
        "llvm-vs-code-extensions.vscode-clangd",
        // Better support for C++ modules than cpptools-extension-pack
        "ms-azuretools.vscode-docker",
        "ms-python.isort",
        "ms-python.mypy-type-checker",
        "ms-python.python",
        // "ms-vscode.cpptools-extension-pack",
        "ms-vscode.cmake-tools",
        // Comment out if using cpptools-extension-pack
        "ms-vscode.cpptools-themes",
        // Comment out if using cpptools-extension-pack
        "ms-vscode.live-server",
        // HTML previews
        "nefrob.vscode-just-syntax",
        "redhat.vscode-yaml",
        "tamasfe.even-better-toml",
        "usernamehw.errorlens",
        "vadimcn.vscode-lldb"
        // LLVM
        // "llvm-vs-code-extensions.vscode-mlir",
        // Rust
        // "rust-lang.rust-analyzer",
        // Python
        // "ktnrg45.vscode-cython",
        // "ms-toolsai.jupyter",
        // Kubernetes
        // "ms-kubernetes-tools.vscode-kubernetes-tools",
        // "redhat.vscode-yaml",
      ]
    }
  },
  "build": {
    "dockerfile": "Containerfile",
    "args": {
      "REMOTE_USER": "dev",
      // https://github.com/devcontainers/spec/issues/631
      // Run `id` on the host to get these
      "HOST_UID": "1001",
      "HOST_GID": "1002"
    }
  },
  "runArgs": [
    // For Podman
    "--userns=keep-id"
  ]
}
// clang-format on